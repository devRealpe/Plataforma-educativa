<div class="modal-backdrop" (click)="onBackdropClick($event)" *ngIf="isOpen">
  <div class="modal-container">
    <!-- Header -->
    <div class="modal-header modal-header-edit">
      <div class="header-content">
        <div class="header-icon">
          <svg
            width="32"
            height="32"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
            />
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
          </svg>
        </div>
        <div>
          <h2 class="modal-title">✏️ Editar Curso</h2>
          <p class="modal-subtitle">
            Actualiza la información de "{{ course.title }}"
          </p>
        </div>
      </div>
      <button class="close-btn" (click)="close()" type="button">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>
    </div>

    <!-- Form -->
    <form (ngSubmit)="onSubmit()" class="modal-form">
      <!-- Título del Curso -->
      <div class="form-group">
        <label class="form-label" for="title">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
            <path
              d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"
            />
          </svg>
          Título del Curso
          <span class="required">*</span>
        </label>
        <input
          type="text"
          id="title"
          class="form-input"
          [(ngModel)]="courseForm.title"
          name="title"
          placeholder="Ej: Matemáticas Avanzadas, Historia del Arte..."
          required
          maxlength="100"
        />
        <div class="input-hint">
          Dale un nombre atractivo y descriptivo a tu curso
        </div>
      </div>

      <!-- Descripción -->
      <div class="form-group">
        <label class="form-label" for="description">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
            />
            <polyline points="14 2 14 8 20 8" />
            <line x1="16" y1="13" x2="8" y2="13" />
            <line x1="16" y1="17" x2="8" y2="17" />
            <polyline points="10 9 9 9 8 9" />
          </svg>
          Descripción
          <span class="required">*</span>
        </label>
        <textarea
          id="description"
          class="form-textarea"
          [(ngModel)]="courseForm.description"
          name="description"
          placeholder="Describe el contenido, objetivos y lo que aprenderán los estudiantes..."
          rows="5"
          required
          maxlength="500"
        ></textarea>
        <div class="char-count">
          <span [class.char-limit]="courseForm.description.length > 450">
            {{ courseForm.description.length }}/500
          </span>
          caracteres
        </div>
      </div>

      <!-- Nivel con iconos visuales -->
      <div class="form-group">
        <label class="form-label" for="level">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polygon points="12 2 2 7 12 12 22 7 12 2" />
            <polyline points="2 17 12 22 22 17" />
            <polyline points="2 12 12 17 22 12" />
          </svg>
          Nivel de Dificultad
          <span class="required">*</span>
        </label>
        <div class="level-grid">
          <label
            *ngFor="let level of levels"
            class="level-option"
            [class.selected]="courseForm.level === level.value"
          >
            <input
              type="radio"
              name="level"
              [value]="level.value"
              [(ngModel)]="courseForm.level"
              class="level-radio"
            />
            <div class="level-card">
              <div class="level-icon">{{ level.icon }}</div>
              <div class="level-info">
                <div class="level-name">{{ level.label }}</div>
                <div class="level-description">{{ level.description }}</div>
              </div>
              <div class="level-check">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="3"
                >
                  <polyline points="20 6 9 17 4 12" />
                </svg>
              </div>
            </div>
          </label>
        </div>
      </div>

      <!-- Indicador de cambios -->
      <div class="info-box info-box-warning" *ngIf="hasChanges()">
        <svg
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"
          />
          <line x1="12" y1="9" x2="12" y2="13" />
          <line x1="12" y1="17" x2="12.01" y2="17" />
        </svg>
        <div>
          <strong>Cambios detectados:</strong> Has modificado la información del
          curso. No olvides guardar los cambios.
        </div>
      </div>

      <!-- Sin cambios -->
      <div
        class="info-box info-box-success"
        *ngIf="!hasChanges() && !isSubmitting"
      >
        <svg
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="20 6 9 17 4 12" />
        </svg>
        <div>No se han detectado cambios en el curso.</div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button
          type="button"
          class="cancel-btn"
          (click)="close()"
          [disabled]="isSubmitting"
        >
          Cancelar
        </button>
        <button
          type="submit"
          class="submit-btn"
          [disabled]="!isFormValid() || isSubmitting || !hasChanges()"
          [class.no-changes]="!hasChanges()"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
            />
            <polyline points="17 21 17 13 7 13 7 21" />
            <polyline points="7 3 7 8 15 8" />
          </svg>
          {{ getSubmitButtonText() }}
        </button>
      </div>
    </form>
  </div>
</div>
