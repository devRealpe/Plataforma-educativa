<div class="app-container">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2L2 7V17L12 22L22 17V7L12 2Z" fill="white" />
            <circle cx="12" cy="12" r="3" fill="#2563eb" />
          </svg>
        </div>
        <h1>Mariana Learning</h1>
      </div>
      <div class="header-actions">
        <button class="profile-btn" (click)="goToProfile()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
          >
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
            <circle cx="12" cy="7" r="4" />
          </svg>
          Mi Perfil
        </button>
        <button class="logout-btn" (click)="logout()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
            <polyline points="16 17 21 12 16 7" />
            <line x1="21" y1="12" x2="9" y2="12" />
          </svg>
          Cerrar Sesión
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div *ngFor="let stat of stats" class="stat-card">
        <div class="stat-info">
          <p class="stat-title">{{ stat.title }}</p>
          <h2 class="stat-value">{{ stat.value }}</h2>
        </div>
        <div class="stat-icon" [style.background-color]="stat.bgColor">
          <span>{{ stat.icon }}</span>
        </div>
      </div>
    </div>

    <!-- Join Course Section -->
    <div class="join-course-section">
      <div class="join-card">
        <div class="join-icon">
          <svg
            width="32"
            height="32"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
            <circle cx="8.5" cy="7" r="4" />
            <polyline points="17 11 19 13 23 9" />
          </svg>
        </div>
        <div class="join-content">
          <h3 class="join-title">Unirse a un Curso</h3>
          <p class="join-description">
            Ingresa el código de invitación proporcionado por tu profesor para
            acceder al curso
          </p>
          <div class="join-input-group">
            <input
              type="text"
              class="join-input"
              placeholder="Ingresa el código (ej: ABC123)"
              [(ngModel)]="inviteCode"
              (keyup.enter)="joinCourse()"
              maxlength="10"
            />
            <button
              class="join-btn"
              (click)="joinCourse()"
              [disabled]="!inviteCode || isJoining"
            >
              <svg
                *ngIf="!isJoining"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M5 12h14" />
                <path d="M12 5l7 7-7 7" />
              </svg>
              <span *ngIf="isJoining" class="spinner"></span>
              {{ isJoining ? "Uniéndose..." : "Unirse al Curso" }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- My Courses Section -->
    <div class="courses-section">
      <div class="section-header">
        <div>
          <h2 class="section-title">Mis Cursos</h2>
          <p class="section-subtitle">Cursos en los que estás inscrito</p>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="enrolledCourses.length === 0" class="empty-state">
        <div class="empty-icon">
          <svg
            width="80"
            height="80"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
            <path
              d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"
            />
          </svg>
        </div>
        <h3 class="empty-title">No estás inscrito en ningún curso</h3>
        <p class="empty-description">
          Solicita un código de invitación a tu profesor y únete a tu primer
          curso
        </p>
      </div>

      <!-- Course Cards -->
      <div
        *ngFor="let course of enrolledCourses"
        class="course-card student-course"
      >
        <div class="course-header">
          <div
            class="course-progress"
            [style.background]="getProgressColor(course.progress)"
          ></div>
          <div class="course-main-info">
            <div class="course-title-row">
              <h3 class="course-title">{{ course.title }}</h3>
              <div class="course-badges">
                <span class="course-level">{{ course.level }}</span>
                <span class="progress-badge"
                  >{{ course.progress }}% Completado</span
                >
              </div>
            </div>
            <p class="course-description">{{ course.description }}</p>

            <!-- Progress Bar -->
            <div class="progress-container">
              <div class="progress-bar">
                <div
                  class="progress-fill"
                  [style.width.%]="course.progress"
                ></div>
              </div>
              <span class="progress-text"
                >{{ course.completedActivities }}/{{
                  course.totalActivities
                }}
                actividades</span
              >
            </div>
          </div>
        </div>

        <!-- Course Stats -->
        <div class="course-stats">
          <div class="stat-item">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M12 2v20M2 12h20" />
            </svg>
            <span>{{ course.totalExercises }} Ejercicios</span>
          </div>
          <div class="stat-item">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" />
              <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" />
              <path d="M4 22h16" />
              <path
                d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"
              />
              <path
                d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"
              />
              <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" />
            </svg>
            <span>{{ course.totalChallenges }} Retos</span>
          </div>
          <div class="stat-item">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polygon
                points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
              />
            </svg>
            <span>{{ course.earnedXP }} XP</span>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button class="action-btn primary" (click)="enterCourse(course)">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M5 12h14" />
              <path d="M12 5l7 7-7 7" />
            </svg>
            Ingresar al Curso
          </button>
          <button class="action-btn secondary" (click)="viewProgress(course)">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21.21 15.89A10 10 0 1 1 8 2.83" />
              <path d="M22 12A10 10 0 0 0 12 2v10z" />
            </svg>
            Ver Progreso
          </button>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Modal Confirmación Cerrar Sesión -->
<app-confirmation-modal
  *ngIf="showLogoutConfirmModal"
  title="¿Cerrar sesión?"
  message="¿Estás seguro de que deseas cerrar sesión?"
  confirmText="Cerrar sesión"
  cancelText="Cancelar"
  type="info"
  (confirm)="confirmLogout()"
  (cancel)="cancelLogout()"
>
</app-confirmation-modal>
